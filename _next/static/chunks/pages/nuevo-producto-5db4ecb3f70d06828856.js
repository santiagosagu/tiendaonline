_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[15],{KQpA:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n("q1tI"),i=s(a),u=s(n("zpNE")),c=s(n("hu/m"));function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function f(e){var t=/(?:\.([^.]+))?$/.exec(e);return null!=t&&null!=t[0]?t[0]:""}var d=function(e){function t(){var e,n,r;l(this,t);for(var o=arguments.length,a=Array(o),i=0;i<o;i++)a[i]=arguments[i];return n=r=p(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.uploadTasks=[],r.handleFileSelection=function(e){for(var t=e.target.files,n=0;n<t.length;n++)r.startUpload(t[n])},p(r,n)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"componentWillUnmount",value:function(){this.cancelRunningUploads()}},{key:"cancelRunningUploads",value:function(){for(;this.uploadTasks.length>0;){var e=this.uploadTasks.pop();"running"===e.snapshot.state&&e.cancel()}}},{key:"removeTask",value:function(e){for(var t=0;t<this.uploadTasks.length;t++)if(this.uploadTasks[t]===e)return void this.uploadTasks.splice(t,1)}},{key:"startUpload",value:function(e){var t=this,n=this.props,r=n.onUploadStart,o=n.onProgress,a=n.onUploadError,i=n.onUploadSuccess,s=n.storageRef,l=n.metadata,p=n.randomizeFilename,d=n.filename,m=void 0;f(m=d?"function"===typeof d?d(e):d:p?(0,u.default)():e.name)||(m+=f(e.name)),Promise.resolve().then((function(){return e.type.match(/image.*/)&&(t.props.maxWidth||t.props.maxHeight)?(0,c.default)(e,t.props.maxWidth,t.props.maxHeight):e})).then((function(e){var n=s.child(m).put(e,l);r&&r(e,n),n.on("state_changed",(function(e){return o&&o(Math.round(100*e.bytesTransferred/e.totalBytes),n)}),(function(e){return a&&a(e,n)}),(function(){return t.removeTask(n),i&&i(n.snapshot.metadata.name,n)})),t.uploadTasks.push(n)}))}},{key:"render",value:function(){var e=this.props,t=(e.storageRef,e.onUploadStart,e.onProgress,e.onUploadSuccess,e.onUploadError,e.randomizeFilename,e.metadata,e.filename,e.maxWidth,e.maxHeight,e.hidden),n=e.as,o=void 0===n?"input":n,a=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["storageRef","onUploadStart","onProgress","onUploadSuccess","onUploadError","randomizeFilename","metadata","filename","maxWidth","maxHeight","hidden","as"]),u=t?Object.assign({},a.style,{width:"0.1px",height:"0.1px",opacity:0,overflow:"hidden",position:"absolute",zIndex:-1}):a.style;return i.default.createElement(o,r({type:"file",onChange:this.handleFileSelection},a,{style:u}))}}]),t}(a.Component);t.default=d},Sfbb:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(e,t,n){for(var r=atob(this.toDataURL(t,n).split(",")[1]),o=r.length,a=new Uint8Array(o),i=0;i<o;i++)a[i]=r.charCodeAt(i);e(new Blob([a],{type:t||"image/png"}))}})}},TCLN:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/nuevo-producto",function(){return n("cf6P")}])},V5hS:function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0===(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},cf6P:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return D}));var r=n("rePB"),o=n("q1tI"),a=n.n(o),i=n("80PL"),u=n("xWvD"),c=n("o0o1"),s=n.n(c),l=n("HaE+"),p=n("h4VS"),f=n("5D9J"),d=n("nOHt"),m=n.n(d),b=n("KQpA"),h=n.n(b),g=a.a.createElement;function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(){var e=Object(p.a)(["\n    background-color: #fff;\n    border-bottom: 2px solid #000;\n    padding: .5rem;\n    margin: 0 auto 2rem auto;\n    width: 280px;\n"]);return O=function(){return e},e}function w(){var e=Object(p.a)(["\n    width: 200px;\n    margin: 0 auto;\n"]);return w=function(){return e},e}function j(){var e=Object(p.a)(["\n    background-color: #fff;\n    border-bottom: 2px solid #000;\n    padding: .5rem;\n    margin: 0 auto 2rem auto;\n    width: 280px;\n\n    @media (min-width: 768px) {\n        width: 300px;\n    }\n\n"]);return j=function(){return e},e}function x(){var e=Object(p.a)(["\n    max-width: 600px;\n    background-color: #fff;\n    padding: 2rem;\n    border-radius: 1rem;\n    margin: 0 auto;\n    border: 1px solid #000;\n\n"]);return x=function(){return e},e}function P(){var e=Object(p.a)(["\n    padding: 0.5rem;\n    margin: 2rem auto;\n    align-items: center;\n\n\n    @media (min-width: 768px) {\n        \n        padding: 2rem;\n    }\n"]);return P=function(){return e},e}var _=f.a.div(P()),S=f.a.form(x()),E=f.a.input(j()),k=f.a.button(w()),C=f.a.textarea(O()),U=function(){var e=Object(o.useState)({nombre:"",categoria:"",imagen:"",descripcion:"",precio:0,creado:Date.now()}),t=e[0],n=e[1],a=Object(o.useState)({error:!1,mensaje:""}),i=a[0],c=a[1],p=t.nombre,f=t.categoria,d=t.descripcion,b=t.precio,v=Object(o.useState)(!1),O=(v[0],v[1]),w=Object(o.useState)(0),j=(w[0],w[1]),x=Object(o.useState)(""),P=x[0],U=x[1],N=Object(o.useState)(""),T=(N[0],N[1]),D=Object(o.useContext)(u.a),R=D.usuario,M=D.firebase;Object(o.useEffect)((function(){n(y(y({},t),{},{imagen:P}))}),[P]);var L=function(){var e=Object(l.a)(s.a.mark((function e(n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),0!==p.trim().length&&0!==f.trim().length&&0!==d.trim().length&&0!==b){e.next=4;break}return c({error:!0,mensaje:"Todos los campos son requeridos"}),e.abrupt("return");case 4:if(R){e.next=6;break}return e.abrupt("return",m.a.push("/"));case 6:return M.db.collection("productos").add(t),e.abrupt("return",m.a.push("/productos"));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return g(_,{className:"container mx-auto"},i.error&&g("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 my-2 rounded relative",role:"alert"},g("strong",{className:"font-bold"},"Error!! "),g("span",{className:"block sm:inline"},i.mensaje),g("span",{onClick:function(){c({error:!1})},className:"absolute top-0 bottom-0 right-0 px-4 py-3"},g("svg",{className:"fill-current h-6 w-6 text-red-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},g("title",null,"Close"),g("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})))),g(S,{className:"text-center mt-2 flex flex-col bg-gray-200",onSubmit:L},g("h2",{className:"font-sans text-3xl mb-5"}," Nuevo Producto "),g("label",null,"Nombre"),g(E,{type:"text",name:"nombre",onChange:function(e){return n(y(y({},t),{},Object(r.a)({},e.target.name,e.target.value)))}}),g("label",null,"Categoria"),g(E,{type:"text",name:"categoria",onChange:function(e){return n(y(y({},t),{},Object(r.a)({},e.target.name,e.target.value)))}}),g("label",null,"imagen"),g(h.a,{accept:"image/*",name:"imagen",randomizeFilename:!0,storageRef:M.storage.ref("productos"),onUploadStart:function(){j(0),O(!0)},onUploadError:function(e){O(e),console.error(e)},onUploadSuccess:function(e){j(100),O(!1),T(e),M.storage.ref("productos").child(e).getDownloadURL().then((function(e){console.log(e),U(e)}))},onProgress:function(e){return j({progreso:e})}}),g("label",null,"Descripcion"),g(C,{rows:"5",cols:"30",name:"descripcion",onChange:function(e){return n(y(y({},t),{},Object(r.a)({},e.target.name,e.target.value)))}}),g("label",null,"Precio"),g(E,{type:"number",name:"precio",placeholder:"$",onChange:function(e){return n(y(y({},t),{},Object(r.a)({},e.target.name,parseInt(e.target.value,10))))}}),g(k,{type:"submit",className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2  px-4 rounded"},"Crear")))},N=a.a.createElement;function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(){var e=Object(o.useState)([{superusuarioRol:!1}]),t=e[0],n=e[1],a=Object(o.useContext)(u.a),c=a.firebase,s=a.usuario,l=t[0].id,p=!1;function f(e){var t=e.docs.map((function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({ids:e.id},e.data())}));n(t)}return s?(console.log("ya se definio"),s.uid===l&&(p=!0)):console.log("usuario no esta definido"),Object(o.useEffect)((function(){c.db.collection("usuario").onSnapshot(f)}),[]),N(i.a,null,p?N(U,null):N("h1",null,"No puedes estar aqui"))}},"hu/m":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){HTMLCanvasElement.prototype.toBlob||(0,a.default)();return new Promise((function(r,o){var a=new FileReader;a.onload=function(a){var i=new Image;i.onload=function(a){var u=document.createElement("canvas"),c=t||i.width,s=n||i.height;u.width=c,u.height=s;var l=c/i.width,p=s/i.height,f=Math.max(l,p),d=f*i.width,m=f*i.height,b=Math.min((s-m)/2,0),h=Math.min((c-d)/2,0),g=u.getContext("2d");if(!g)return o("Could not get the context of the canvas element");g.drawImage(i,h,b,d,m),u.toBlob((function(e){r(e)}),e.type)},i.src=a.target.result},a.readAsDataURL(e)}))};var r,o=n("Sfbb"),a=(r=o)&&r.__esModule?r:{default:r}},rnWd:function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,o=n;return[o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]]].join("")}},zpNE:function(e,t,n){var r=n("V5hS"),o=n("rnWd");e.exports=function(e,t,n){var a=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||r)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var u=0;u<16;++u)t[a+u]=i[u];return t||o(i)}}},[["TCLN",1,2,3,4,0,5,6]]]);